<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="css.css" rel="stylesheet" type="text/css">
    <title></title>
</head>
<body>
<div  class="load8"  >
    <div class="mid">
        <div class="loader"></div>
        <div class="loading">
            正在努力加载
        </div>
    </div>
</div>
<div class="land">
  <div class="mid">
      <img  id="logo" src="logo.png">
      <div class="landText">
          今天去xxxx<br>
          会邂逅谁呢？
      </div>
      <div  id="getIn" class="landBtn">
        去占卜罗盘
      </div>
  </div>
</div>
<div   class=" score">
    <div class="mid">
        <div id="result">
            我将会在******邂逅<br>
            <span id="who">某某某某某</span>

        </div>
        <div class="btnG">

            <div id="share">
                <img src="share.png">
            </div>
            <div id="replay">
                <img src="replay.png">
            </div>
        </div>

    </div>
</div>
<div id="game"  >
  <div class="mid">
      <div class="cover">
          <img src="o.png"  id="o"    >
      </div>
      <div class="cover">
          <img src="i.png"  id="i"   >
      </div>
      <div class="cover">
          <img src="c.png"   >
      </div>
      <div id="s" class="cover">
          <img src="s.png"   >
      </div>

      <div class="btn" id="start">

      </div>

  </div>
</div>

<script src="http://libs.baidu.com/zepto/0.8/zepto.min.js"></script>
<script>
    var tu='http://cdn4.hbimg.cn/store/wm/bigfiles/201337/D525A2FC85A29AD1E9F2888634.jpg';
    var desc='describe test'
    var title='title test'
    $(function(){
        function get(r1,r2){
            console.log(r1)
            console.log(r2)
            r1=r1%360;
            r2=r2%360;
            r2=r2+27;
            if(r2>360){
                r2=r2-360
            }
            console.log(r1);
            console.log(r2);


            $('#who').html(a1[Math.floor(r1/60)]+a2[Math.floor(r2/60)])
        }
        var a1=['失足的','一见钟情的','出柜的','看破红尘的','心怀不轨的','暗恋你的'];
        var a2=['舍友','班主任','路人','店老板','前任','班长'];
        var b=true;
        var g=true;
        var r1=0;
        var r2=0;
        var d1=11;
        var d2=14;
        var fps = 25;
        var now;
        var then = Date.now();
        var interval = 1000/fps;
        var delta;
        function draw(){
                r1=r1+d1;
                r2=r2-d2;
                var k1="rotate("+r1+"deg)";
                var k2="rotate("+r2+"deg)";
                console.log(k2)
                $('#o').css({'-webkit-transform':k1,'transform':k1})
                $('#i').css({'-webkit-transform':k2,'transform':k2})
        }
        function tick(){
            requestAnimationFrame(tick);
            now=Date.now();
            delta=now-then;
            if(delta>interval){
                then=now-(delta%interval);
                if(b){
                    draw();
                }
            }
        }
        $('#start').tap(function(){
            if(g){
                b=true
                tick();
                g=false;
                $('#start').addClass('active')
            }else{
                if(b){
                    function showS(){
                        $('.score').addClass('slideIn');
                        $('.score').removeClass('slideOut');
                    }
                    function done(){
                        $("#s").addClass('done')
                    }
                    setTimeout(done,100);
                    setTimeout(showS,2000);
                }
                b=false;
                get(r1,(-1)*r2);

            }
        })
        $('#replay').tap(function(){
            r1=0;
            r2=0;
//            $('#o').css({'-webkit-transform':'rotate(0)','transform':'rotate(0)'})
//            $('#i').css({'-webkit-transform':'rotate(0)','transform':'rotate(0)'})
            $('.score').addClass('slideOut')
            $('.score').removeClass('slideIn')
            $('#s').removeClass('done')
            $('#start').removeClass('active')
            g=true;


        })
        $('#getIn').tap(function(){
            $('.land').addClass('slideOut');
        })

    })

window.onload=function(){
    $(function(){
        $('.load8').addClass('slideOut');
        $('.score').addClass('slideOut');
    })
}



    document.addEventListener('WeixinJSBridgeReady',
            function onBridgeReady() {
                WeixinJSBridge.on('menu:share:appmessage',
                        function(argv) {
                            WeixinJSBridge.invoke('sendAppMessage', {
                                        "img_url": tu,
                                        "link": document.location.href,
                                        "desc": describe,
                                        "title":title
                                    },
                                    function(res) {
                                        document.location.href = window.shareData.timeLineLink;
                                    })
                        });
                WeixinJSBridge.on('menu:share:timeline',
                        function(argv) {
                            WeixinJSBridge.invoke('shareTimeline', {
                                        "img_url": tu,
                                        "img_width": "640",
                                        "img_height": "640",
                                        "link": 'http://baidu.com',
                                        "desc": desc,
                                        "title":title
                                    },
                                    function(res) {
                                        document.location.href = window.shareData.timeLineLink;
                                    });
                        });
            }, false);
</script>
</body>
</html>